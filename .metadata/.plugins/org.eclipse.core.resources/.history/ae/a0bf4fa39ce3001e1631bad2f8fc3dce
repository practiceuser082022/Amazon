package com.amazon.tests;

import static org.testng.Assert.assertEquals;

import java.util.Properties;

import org.apache.commons.lang3.RandomStringUtils;
import org.apache.commons.lang3.RandomUtils;
import org.openqa.selenium.WebDriver;
import org.testng.annotations.BeforeSuite;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import com.amazon.pageoperations.CommonPageOperations;
import com.amazon.pageoperations.CreateAccountPageOperations;
import com.amazon.pageoperations.LogOutPageOperations;
import com.amazon.pageoperations.LoginPageOperations;
import com.amazon.pageoperations.ProductPageOperations;
import com.amazon.pageoperations.SearchProductPageOperations;

public class AddProductsTest extends BaseTest {
  public WebDriver webDriver;
  LoginPageOperations loginPageOperations;
  CreateAccountPageOperations createAccountPageOperations;
  SearchProductPageOperations searchProductPageOperations;	
  CommonPageOperations commonPageOperations;
  ProductPageOperations productPageOperations;
  LogOutPageOperations logOutPageOperations;
  
  
	@BeforeTest
	public void setup() {

		webDriver=getDriver();		
		loginPageOperations=new LoginPageOperations(webDriver);
		createAccountPageOperations=new CreateAccountPageOperations(webDriver);
		searchProductPageOperations=new SearchProductPageOperations(webDriver);
		commonPageOperations=new CommonPageOperations(webDriver);
		productPageOperations=new ProductPageOperations(webDriver);
		logOutPageOperations=new LogOutPageOperations(webDriver);
	}

	@Test
	public void createAccout() {
		
		createAccountPageOperations.enterUserName(RandomStringUtils.randomAlphabetic(10));
		createAccountPageOperations.enterPassword(RandomStringUtils.randomNumeric(10));
		createAccountPageOperations.enterPhoneNumber(RandomStringUtils.randomNumeric(10));
		
		
	}
	@Test(priority=2)
	public void addProductsToCart() {
		
		Properties userProperties=getUserInfo();
	
		webDriver.get(getEnvUrl());
		
		loginPageOperations.clickOnSignInLink();
		loginPageOperations.enterEmailOrPhoneNumber(userProperties.getProperty("username"));
		loginPageOperations.clickOnContinue();
		loginPageOperations.enterPassword(userProperties.getProperty("password"));
		loginPageOperations.clickOnSignIn();		
		
		webDriver.navigate().to(getEnvUrl());
		searchProductPageOperations.enterProductNameAndSearch("sony bravia 55 inch tv");
		searchProductPageOperations.selectProductByPrice("50000");
		commonPageOperations.switchToChild();
		productPageOperations.addProductToCart();
		productPageOperations.clickACart();	
		//assertEquals(2, productPageOperations.getAddedProducts().size());
		commonPageOperations.switchToParent();
		
		webDriver.navigate().to(getEnvUrl());
		searchProductPageOperations.enterProductNameAndSearch("Sony Bravia 189 cm (75 inches)");
		searchProductPageOperations.selectProductByPriceRanage("100000","150000");
		commonPageOperations.switchToChild();
		productPageOperations.addProductToCart();
		productPageOperations.clickACart();
		System.out.println(productPageOperations.getAddedProducts().size());
		//assertEquals(4, productPageOperations.getAddedProducts().size());
		commonPageOperations.switchToParent();
		
		searchProductPageOperations.enterProductNameAndSearch("sony home theater");
		searchProductPageOperations.selectProductByPriceRanage("20000","50000");
		commonPageOperations.switchToChild();
		productPageOperations.addProductToCart2();
		productPageOperations.clickACart();	
		System.out.println(productPageOperations.getAddedProducts().size());
		//assertEquals(6, productPageOperations.getAddedProducts().size());
		commonPageOperations.switchToParent();
		
		logOutPageOperations.clickOnAccountsAndListLink();
		logOutPageOperations.clickOnSignOutLink();
		
	}
}


package com.amazon.tests;

import static org.testng.Assert.assertEquals;

import java.util.Properties;

import org.openqa.selenium.WebDriver;
import org.testng.annotations.BeforeSuite;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import com.amazon.pageoperations.CommonPageOperations;
import com.amazon.pageoperations.CreateAccountPageOperations;
import com.amazon.pageoperations.LoginPageOperations;
import com.amazon.pageoperations.ProductPageOperations;
import com.amazon.pageoperations.SearchProductPageOperations;

public class AddProductsTest extends BaseTest {
  public WebDriver webDriver;
  LoginPageOperations loginPageOperations;
  CreateAccountPageOperations createAccountPageOperations;
  SearchProductPageOperations searchProductPageOperations;	
  CommonPageOperations commonPageOperations;
  ProductPageOperations productPageOperations;
  
	@BeforeTest
	public void setup() {

		webDriver=getDriver();		
		loginPageOperations=new LoginPageOperations(webDriver);
		createAccountPageOperations=new CreateAccountPageOperations(webDriver);
		searchProductPageOperations=new SearchProductPageOperations(webDriver);
		commonPageOperations=new CommonPageOperations(webDriver);
		productPageOperations=new ProductPageOperations(webDriver);
		
	}

	@Test
	public void createAccout() {
		
		createAccountPageOperations.enterName("Raj");
	}
	@Test(priority=2)
	public void addProductsToCart() {
		
		Properties userProperties=getUserInfo();
	
		webDriver.get(getEnvUrl());
		
		loginPageOperations.clickOnSignInLink();
		loginPageOperations.enterEmailOrPhoneNumber(userProperties.getProperty("username"));
		loginPageOperations.clickOnContinue();
		loginPageOperations.enterPassword(userProperties.getProperty("password"));
		loginPageOperations.clickOnSignIn();		
		
		
		searchProductPageOperations.enterProductNameAndSearch("sony bravia");
		searchProductPageOperations.selectProductByPrice("50000");
		commonPageOperations.switchToChild();
		productPageOperations.addProductToCart();
		productPageOperations.clickACart();	
		assertEquals(2, productPageOperations.getAddedProducts().size());
		commonPageOperations.switchToChild();
		
		searchProductPageOperations.enterProductNameAndSearch("sony bravia");
		searchProductPageOperations.selectProductByPriceRanage("100000","150000");
		commonPageOperations.switchToChild();
		productPageOperations.addProductToCart();
		productPageOperations.clickACart();
		System.out.println(productPageOperations.getAddedProducts().size());
		//assertEquals(4, productPageOperations.getAddedProducts().size());
		
		searchProductPageOperations.enterProductNameAndSearch("sony home theater");
		searchProductPageOperations.selectProductByPriceRanage("20000","50000");
		commonPageOperations.switchToChild();
		productPageOperations.addProductToCart();
		productPageOperations.clickACart();	
		System.out.println(productPageOperations.getAddedProducts().size());
		//assertEquals(6, productPageOperations.getAddedProducts().size());
		
		
	}
}

